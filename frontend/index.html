<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chain Lens â€” Bitcoin Transaction Analyzer</title>
  <meta name="description"
    content="Analyze Bitcoin transactions and blocks with visual diagrams and plain-English explanations.">
  <link rel="stylesheet" href="styles.css">
</head>

<body>

  <!-- â”€â”€â”€ Header â”€â”€â”€ -->
  <div class="header">
    <div class="logo">
      <svg viewBox="0 0 100 100" fill="currentColor">
        <circle cx="50" cy="50" r="45" fill="none" stroke="currentColor" stroke-width="6" />
        <text x="50" y="68" text-anchor="middle" font-size="48" font-weight="bold" fill="currentColor">â‚¿</text>
      </svg>
      Chain Lens
    </div>
    <div class="header-nav">
      <button class="nav-btn active" id="nav-tx" onclick="switchMode('tx')">Transaction</button>
      <button class="nav-btn" id="nav-block" onclick="switchMode('block')">Block</button>
    </div>
  </div>

  <div class="container">

    <!-- â”€â”€â”€ Transaction Input â”€â”€â”€ -->
    <div id="tx-input" class="input-section">
      <h2>ğŸ“‹ Transaction Fixture</h2>
      <textarea id="fixture-input" placeholder='Paste your transaction fixture JSON hereâ€¦

{
  "network": "mainnet",
  "raw_tx": "0200000001...",
  "prevouts": [{ "txid": "...", "vout": 0, "value_sats": 123456, "script_pubkey_hex": "..." }]
}'></textarea>
      <div class="btn-group">
        <button class="btn btn-primary" id="btn-analyze-tx" onclick="analyzeTransaction()">ğŸ” Analyze
          Transaction</button>
        <button class="btn btn-secondary" onclick="loadSample()">ğŸ“„ Load Sample</button>
      </div>
    </div>

    <!-- â”€â”€â”€ Block Input â”€â”€â”€ -->
    <div id="block-input" class="input-section" style="display:none">
      <h2>ğŸ“¦ Block Files</h2>
      <div class="file-inputs">
        <div class="file-input-wrapper" id="blk-wrap">
          <input type="file" id="blk-file" onchange="updateFileName(this,'blk-name','blk-wrap')">
          <div class="file-label">blk*.dat</div>
          <div class="file-name" id="blk-name">Drop or click</div>
        </div>
        <div class="file-input-wrapper" id="rev-wrap">
          <input type="file" id="rev-file" onchange="updateFileName(this,'rev-name','rev-wrap')">
          <div class="file-label">rev*.dat</div>
          <div class="file-name" id="rev-name">Drop or click</div>
        </div>
        <div class="file-input-wrapper" id="xor-wrap">
          <input type="file" id="xor-file" onchange="updateFileName(this,'xor-name','xor-wrap')">
          <div class="file-label">xor.dat</div>
          <div class="file-name" id="xor-name">Drop or click</div>
        </div>
      </div>
      <button class="btn btn-primary" id="btn-analyze-block" onclick="analyzeBlock()">ğŸ“¦ Analyze Block</button>
    </div>

    <!-- â”€â”€â”€ Loading â”€â”€â”€ -->
    <div id="loading" class="loading" style="display:none">
      <p><span class="spinner"></span> Analyzingâ€¦ this may take a moment for large blocks.</p>
    </div>

    <!-- â”€â”€â”€ Error â”€â”€â”€ -->
    <div id="error-display"></div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         Transaction Result
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="result">
      <!-- Story narrative -->
      <div id="story-narrative" class="story-narrative"></div>

      <!-- Metric cards -->
      <div id="metrics-grid" class="metrics-grid"></div>

      <!-- Warnings -->
      <div id="warnings-section" class="warnings-bar"></div>

      <!-- Flow graph: inputs â†’ outputs + fee -->
      <div class="flow-section">
        <h2>ğŸ’° Value Flow</h2>
        <div id="flow-graph" class="flow-graph"></div>
      </div>

      <!-- SegWit savings -->
      <div id="segwit-section" class="details-section" style="display:none">
        <div class="details-header" onclick="toggleDetails(this)">
          <h3>ğŸ“Š SegWit Discount Visualization</h3><span>â–¼</span>
        </div>
        <div class="details-body open" id="segwit-body"></div>
      </div>

      <!-- Technical details (hidden by default) -->
      <div class="details-section">
        <div class="details-header" onclick="toggleDetails(this)">
          <h3>ğŸ”§ Show Technical Details</h3><span>â–¼</span>
        </div>
        <div class="details-body" id="tech-details"></div>
      </div>

      <!-- Inputs detail -->
      <div class="details-section">
        <div class="details-header" onclick="toggleDetails(this)">
          <h3>ğŸ“¥ Inputs</h3><span>â–¼</span>
        </div>
        <div class="details-body" id="inputs-detail"></div>
      </div>

      <!-- Outputs detail -->
      <div class="details-section">
        <div class="details-header" onclick="toggleDetails(this)">
          <h3>ğŸ“¤ Outputs</h3><span>â–¼</span>
        </div>
        <div class="details-body" id="outputs-detail"></div>
      </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         Block Result
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="block-result">
      <!-- Story -->
      <div id="block-story" class="story-narrative"></div>

      <!-- Overview cards -->
      <div id="block-overview" class="metrics-grid"></div>

      <!-- Transaction list (expandable) -->
      <div class="details-section">
        <div class="details-header" onclick="toggleDetails(this)">
          <h3>ğŸ“‹ Transactions</h3><span>â–²</span>
        </div>
        <div class="details-body open" id="block-tx-list"></div>
      </div>
    </div>

  </div>

  <script src="app.js"></script>
</body>

</html>